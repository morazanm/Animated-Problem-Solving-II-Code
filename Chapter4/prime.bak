;; The first three lines of this file were inserted by DrRacket. They record metadata
;; about the language level of this file in a form that our tools can easily process.
#reader(lib "htdp-advanced-reader.ss" "lang")((modname prime) (read-case-sensitive #t) (teachpacks ((lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp"))) (htdp-settings #(#t constructor repeating-decimal #t #t none #f ((lib "image.rkt" "teachpack" "2htdp") (lib "universe.rkt" "teachpack" "2htdp")) #f)))
;; natnum --> Boolean
;; Purpose: Determine if given natnum is a prime
(define (prime? n)
  (local [(define (any-divide? low high)
            (if (< high low)
                #false
                (or (= (remainder n high) 0)
                    (any-divide? low (sub1 high)))))]
    (if (< n 2)
        #false
        (not (any-divide? 2 (quotient n 2))))))

;; Tests using sample values for prime?
(check-satisfied 17  prime?)
(check-satisfied 97  prime?)
(check-satisfied 51  (λ (n) (not (prime? n))))
(check-satisfied 121 (λ (n) (not (prime? n))))

;; natnum --> Boolean
;; Purpose: Determine if given natnum is a prime
(define (prime2? n)
  (local [(define (all-primes<=n lon)
            (if (< (length lon) (first lon))
                lon
                (cons (first lon)
                      (all-primes<=n (filter (λ (n) (not (= (remainder n (first lon)) 0)))
                                             (rest lon))))))]
    (if (< n 2)
        #false
        (member? n (all-primes<=n (rest (rest (build-list (add1 n) (λ (i) i)))))))))

;; Tests using sample values for prime2?
(check-satisfied 17  prime2?)
(check-satisfied 97  prime2?)
(check-satisfied 51  (λ (n) (not (prime2? n))))
(check-satisfied 121 (λ (n) (not (prime2? n))))

(time (prime?  10009))
(time (prime2? 10009))
